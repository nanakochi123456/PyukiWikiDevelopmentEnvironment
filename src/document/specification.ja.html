<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"><html><head><meta http-equiv="Content-Language" content="ja"><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="Content-Style-Type" content="text/css"><title>PyukiWiki Document</title><style type="text/css">
body,td{color:black;background-color:white;margin-left:2%;margin-right:2%;font-size:100%;font-family:verdana,arial,helvetica,Sans-Serif}strong{text-shadow:inherit 0px 0px 0px;font-weight:bold}a:link{color:#215dc6;background-color:inherit;text-decoration:none}a:active{color:#215dc6;background-color:inherit;text-decoration:none}a:visited{color:#a63d21;background-color:inherit;text-decoration:none}a:hover{color:#215dc6;background-color:#CCDDEE;text-decoration:underline}h2{font-family:verdana,arial,helvetica,Sans-Serif;color:inherit;background-color:#DDEEFF;padding:.3em;border:0px;margin:0px 0px .5em 0px}h3{font-family:verdana,arial,helvetica,Sans-Serif;border-bottom:3px solid #DDEEFF;border-top:1px solid #DDEEFF;border-left:10px solid #DDEEFF;border-right:5px solid #DDEEFF;color:inherit;background-color:#FFFFFF;padding:.3em;margin:0px 0px .5em 0px}h4{font-family:verdana,arial,helvetica,Sans-Serif;border-left:18px solid #DDEEFF;color:inherit;background-color:#FFFFFF;padding:.3em;margin:0px 0px .5em 0px}font-weight:bold;background-color:transparent;padding:12px0px0px0px;border:0px;margin:12px0px0px0px}h1.error{color:red}*/ div#navigator{clear:both;padding:4px 0px 0px 0px;margin:0px}thead td.style_td,tfoot td.style_td{color:inherit;background-color:#d0d8e0}thead th.style_th,tfoot th.style_th{color:inherit;background-color:#e0e8f0}.style_table{padding:0px;border:0px;text-align:left;width:auto;margin-left:auto;margin-right:auto;color:inherit;background-color:#ccd5dd}.style_th{padding:5px;margin:1px;text-align:center;color:inherit;background-color:#eeeeee}.style_td{padding:5px;margin:1px;color:inherit;background-color:#eef5ff}
</style></head><body><p></p><p></p><h2 id="i5079756B6957696B69BBC5CDCDBDF1A1CAB2BEA1CB0">PyukiWiki仕様書（仮）</h2><p></p><blockquote><blockquote><p class="quotation">&quot;PyukiWiki&quot; ver 0.2.1-customoer-preview $$<br/>Copyright (C) 2005-2015 PukiWiki Developers Team<br/>Copyright (C) 2004-2015 Nekyo (Based on PukiWiki, YukiWiki)<br/>License: GPL version 3 or (at your option) any later version<br/>and/or Artistic version 1 or later version.<br/>Based on YukiWiki <a href="http://www.hyuki.com/yukiwiki/" class="url" target="_blank" title="http://www.hyuki.com/yukiwiki/" rel="nofollow">http://www.hyuki.com/yukiwiki/</a><br/>and PukiWiki <a href="http://pukiwiki.sfjp.jp/" class="url" target="_blank" title="http://pukiwiki.sfjp.jp/" rel="nofollow">http://pukiwiki.sfjp.jp/</a><br/>URL:<br/><a href="http://pyukiwiki.info/" class="url" target="_blank" title="http://pyukiwiki.info/" rel="nofollow">http://pyukiwiki.info/</a><br/><br/>MAIL:<br/>ななみ &lt;nanami (at) daiba (dot) cx&gt; (注：バーチャル女の子です)<br/><br/>$Id$<br/>This text file written UTF-8 Codeset</p></blockquote></blockquote><p></p><div class="jumpmenu"><a href="?#navigator">&uarr;</a></div><h2 id="iCCDCBCA11">目次</h2><div class="contents"> <a id="i636F6E74656E747353"></a> <ul><li><a href="?#i5079756B6957696B69BBC5CDCDBDF1A1CAB2BEA1CB0">PyukiWiki仕様書（仮）</a></li><li><a href="?#iCCDCBCA11">目次</a></li><li><a href="?#iC3EDB0D52">注意</a></li><li><a href="?#i434749B5AFC6B03">CGI起動</a></li><li><a href="?#iA5C7A5A3A5ECA5AFA5C8A5EAB9BDC0AE4">ディレクトリ構成</a></li><li><a href="?#iBCE7A4CACBDCC2CEA5D5A5A1A5A4A5EBB9BDC0AE5">主な本体ファイル構成</a></li><li><a href="?#iBCE7A4CA7065726CA5E2A5B8A5E5A1BCA5EBB9BDC0AE6">主なperlモジュール構成</a></li><li><a href="?#iBCE7A4CA4578706C7567696EB9BDC0AE7">主なExplugin構成</a></li><li><a href="?#iBCE7A4CAA5D7A5E9A5B0A5A4A5F3B9BDC0AE8">主なプラグイン構成</a></li><li><a href="?#i6578706C7567696EBBC5CDCDBEF0CAF39">explugin仕様情報</a></li><ul><li><a href="?#iBDE9B4FCB2BD10">初期化</a></li><li><a href="?#iCDADB8FAA4CBA4CAA4C3A4C6A4A4A4EB6578706C7567696EA4CEB6AFC0A9C6C9A4DFB9FEA4DF11">有効になっているexpluginの強制読み込み</a></li><li><a href="?#iA5EAA5BDA1BCA5B9A4CEC6C9A4DFB9FEA4DF12">リソースの読み込み</a></li><li><a href="?#i4A617661536372697074A1A2435353A4CEC6C9A4DFB9FEA4DF13">JavaScript、CSSの読み込み</a></li><li><a href="?#iBDE9B4FCB2BDBBFEA4CECAD6A4EAC3CDA1CAA5CFA5C3A5B7A5E5A1CB14">初期化時の返り値（ハッシュ）</a></li></ul><li><a href="?#iA5D7A5E9A5B0A5A4A5F3BBC5CDCDBEF0CAF315">プラグイン仕様情報</a></li><ul><li><a href="?#iBDE9B4FCB2BD16">初期化</a></li><li><a href="?#iA5EAA5BDA1BCA5B9A4CEC6C9A4DFB9FEA4DF17">リソースの読み込み</a></li><li><a href="?#i4A617661536372697074A1A2435353A4CEC6C9A4DFB9FEA4DF18">JavaScript、CSSの読み込み</a></li><li><a href="?#i696E6C696E65A5E1A5BDA5C3A5C919">inlineメソッド</a></li><li><a href="?#i636F6E76657274A5E1A5BDA5C3A5C920">convertメソッド</a></li><li><a href="?#i616374696F6EA5E1A5BDA5C3A5C921">actionメソッド</a></li><li><a href="?#i616374696F6EA5E1A5BDA5C3A5C9A4CECAD6A4EAC3CDA1CAA5CFA5C3A5B7A5E5A1CB22">actionメソッドの返り値（ハッシュ）</a></li></ul><li><a href="?#iC6E2C9F4CAD1BFF4BBC5CDCDBEF0CAF323">内部変数仕様情報</a></li><li><a href="?#i4A617661536372697074B4D8BFF4BBC5CDCDB0ECCDF724">JavaScript関数仕様一覧</a></li><ul><li><a href="?#i756125">ua</a></li><li><a href="?#i6C6E26">ln</a></li><li><a href="?#i73696E7327">sins</a></li><li><a href="?#i73696E737328">sinss</a></li><li><a href="?#i67696429">gid</a></li><li><a href="?#i6F7530">ou</a></li><li><a href="?#i6B6579436F646531">keyCode</a></li><li><a href="?#i676574436C69656E74576964746832">getClientWidth</a></li><li><a href="?#i676574436C69656E7448656967687433">getClientHeight</a></li><li><a href="?#i676574446F6348656967687434">getDocHeight</a></li><li><a href="?#i6765745363726F6C6C5935">getScrollY</a></li><li><a href="?#i617236">ar</a></li><li><a href="?#i646566696E656437">defined</a></li><li><a href="?#i7265706C616365416C6C38">replaceAll</a></li><li><a href="?#i6874747039">http</a></li><ul><li><a href="?#i6F6B66756E6340">okfunc</a></li><li><a href="?#i65727266756E6341">errfunc</a></li><li><a href="?#i6874747072657142">httpreq</a></li></ul><li><a href="?#i65762E61646443">ev.add</a></li><li><a href="?#i65762E64656C44">ev.del</a></li><li><a href="?#i65762E657845">ev.ex</a></li><li><a href="?#i646562756746">debug</a></li></ul><li><a href="?#i5853B4CAB0D7BBC5CDCDBDF147">XS簡易仕様書</a></li><ul><li><a href="?#iCCDCBCA148">目次</a></li><li><a href="?#iBCC2C1F5CCDCC9B849">実装目標</a></li><li><a href="?#iA5A4A5F3A5B9A5C8A1BCA5EBC5F950">インストール等</a></li><li><a href="?#i7065726C205853A5E2A5B8A5E5A1BCA5EBA4CEBAEEC0AECAFDCBA151">perl XSモジュールの作成方法</a></li><li><a href="?#iA5D5A5A1A5A4A5EBC6E2CDC652">ファイル内容</a></li></ul></ul></div><p></p><div class="jumpmenu"><a href="?#navigator">&uarr;</a></div><h2 id="iC3EDB0D52">注意</h2>突然、何らかの理由で、仕様変更を行なうことがあります。<br/>この説明書は、参考までで、内容を保障するものではありません。<p></p><div class="jumpmenu"><a href="?#navigator">&uarr;</a></div><h2 id="i434749B5AFC6B03">CGI起動</h2>CGIは、通常の index.cgi形式、及び、nph-index.cgi形式で起動されます。mod_perl環境で動作はしますが、あくまで互換環境での動作となります。<p>多くの環境変数が Apacheに依存していますが、一部のみIISで動作確認は行なわれています。</p><p>urlhack.inc.cgi Explugin は、PATH_INFO、または、404 ステータスの戻り値の、REDIRECT_URL を参照して、ページ名を決定します。PATH_INFOのが汎用性が高い分、制限がありますが、REDIRECT_URLのが、自由度が高く設定できます。</p><p></p><p></p><div class="jumpmenu"><a href="?#navigator">&uarr;</a></div><h2 id="iA5C7A5A3A5ECA5AFA5C8A5EAB9BDC0AE4">ディレクトリ構成</h2><ul class="list1"><li>attach<br/>添付ファイル（添付画像も直接参照します）</li><li>backup<br/>バックアップ</li><li>blib<br/>perl XSモジュール</li><li>cache<br/>システムキャッシュ</li><li>counter<br/>アクセスカウンター</li><li>diff<br/>差分</li><li>image<br/>画像</li><li>info<br/>情報ディレクトリ</li><li>lib<br/>本体、perlモジュール、Explugin</li><li>links<br/>逆リンク用（拡張）</li><li>logs<br/>アクセスログ保存用（拡張）</li><li>plugin<br/>プラグイン</li><li>resource<br/>リソース</li><li>session<br/>予約</li><li>skin<br/>スキンファイル、JavaScript、CSSファイル</li><li>trackback<br/>トラックバック保存用（拡張）</li><li>user<br/>予約</li><li>wiki<br/>Wiki文書</li><li>wikidb<br/>内部のURL短縮用（拡張）</li></ul><p></p><p></p><div class="jumpmenu"><a href="?#navigator">&uarr;</a></div><h2 id="iBCE7A4CACBDCC2CEA5D5A5A1A5A4A5EBB9BDC0AE5">主な本体ファイル構成</h2><ul class="list1"><li>index.cgi<br/>wrapper</li><li>lib/wiki.cgi<br/>本体起動</li><li>lib/wiki_init.cgi<br/>初期化用</li><li>lib/wiki_auth.cgi<br/>認証モジュール</li><li>lib/wiki_db.cgi<br/>データベース</li><li>lib/wiki_func.cgi<br/>汎用関数</li><li>lib/wiki_html.cgi<br/>HTML生成</li><li>lib/wiki_http.cgi<br/>HTTPモジュール</li><li>lib/wiki_link.cgi<br/>リンク用モジュール</li><li>lib/wiki_plugin.cgi<br/>プラグイン用モジュール</li><li>lib/wiki_spam.cgi<br/>スパムフィルターモジュール</li><li>lib/wiki_skin.cgi<br/>スキンモジュール</li><li>lib/wiki_sub.cgi<br/>自動生成される内部サブルーチン定義スクリプト</li><li>lib/wiki_version.cgi<br/>バージョン記述のためのモジュール</li><li>lib/wiki_wiki.cgi<br/>その他のモジュール</li><li>lib/wiki_write.cgi<br/>書き込み用モジュール</li></ul><p></p><p></p><div class="jumpmenu"><a href="?#navigator">&uarr;</a></div><h2 id="iBCE7A4CA7065726CA5E2A5B8A5E5A1BCA5EBB9BDC0AE6">主なperlモジュール構成</h2><ul class="list1"><li>lib/Algorithm/Diff.pm<br/>差分生成用</li><li>lib/AWS 以下<br/>アクセスログ、ユーザーエイジェント振り分け用</li><li>lib/Digest/Perl/MD5.pm<br/>Pure Perl MD5モジュール</li><li>lib/File 以下<br/>ファイル判定用モジュール</li><li>lib/HTTP/Lite.pm<br/>簡易HTTPクライアント(未使用）</li><li>lib/IDNA/Punycode.pm<br/>国際化ドメイン用モジュール（URLでも使用）</li><li>lib/Jcode.pm、lib/Jocde 以下<br/>Jcode.pm</li><li>lib/Time/Local.pm<br/>Time::Local</li><li>lib/Nana/Cache.pm<br/>キャッシュ管理モジュール</li><li>lib/Nana/Cookie.pm<br/>クッキー管理モジュール</li><li>lib/Nana/Enc.pm<br/>簡易暗号化モジュール</li><li>lib/Nana/File.pm<br/>ファイルアクセスモジュール</li><li>lib/Nana/GZIP.pm<br/>gzip圧縮、解凍モジュール</li><li>lib/Nana/HTMLOpt.pm<br/>HTML最適化モジュール</li><li>lib/Nana/HTTP.pm<br/>HTTPアクセスモジュール</li><li>lib/Nana/HTTPCompress.pm<br/>HTTP gzip圧縮出力モジュール</li><li>lib/Nana/Lock.pm<br/>ファイルロックモジュール</li><li>lib/Nana/Logs.pm<br/>アクセスログ解析モジュール</li><li>lib/Nana/Mail.pm<br/>メール送信モジュール</li><li>lib/Nana/MD5.pm<br/>互換MD5生成wrapperモジュール</li><li>lib/Nana/Pod2Wiki.pm<br/>perl pod 簡易変換モジュール</li><li>lib/Nana/RemoteHost.pm<br/>リモートホスト取得モジュール</li><li>lib/Nana/Search.pm<br/>あいまい検索モジュール</li><li>lib/Nana/ServerInfo.pm<br/>サーバー情報取得モジュール</li><li>lib/Nana/YukiWikiDB.pm<br/>ロック対策済 YukiWikiDBモジュール</li><li>lib/Nana/YukiWikiDB_GZIP.pm<br/>↑のgzip圧縮対応版</li><li>lib/Yuki/DiffText.pm<br/>Diff.pm を共用した差分生成モジュール</li><li>lib/Yuki/RSS.pm<br/>RSS1.0モジュール</li><li>lib/Yuki/YukiWikiDB.pm<br/>YukiWikiDB.pm のオリジナル</li></ul><p></p><p></p><div class="jumpmenu"><a href="?#navigator">&uarr;</a></div><h2 id="iBCE7A4CA4578706C7567696EB9BDC0AE7">主なExplugin構成</h2><ul class="list1"><li>lib/aguse.inc.pl<br/>リンク先チェッカー</li><li>lib/antispam.inc.pl<br/>メールアドレス簡易暗号化</li><li>lib/antispamwiki.inc.pl<br/>簡易アンチスパム</li><li>lib/authadmin_cookie.inc.pl<br/>管理者パスワードのcookie簡易保存</li><li>lib/autometarobot.inc.pl<br/>自動ロボット向けキーワード抽出</li><li>lib/canonical.inc.pl<br/>重複URL防止</li><li>lib/captcha.inc.pl<br/>CAPTCHAスパム対策</li><li>lib/debug.inc.pl<br/>デバッグ（develのみ）</li><li>lib/iecompatiblehack.inc.pl<br/>IEの互換表示ボタンをなくす</li><li>lib/lang.inc.pl<br/>国際化対応モジュール</li><li>lib/linktrack.inc.pl<br/>外部リンク簡易トラッキングモジュール</li><li>lib/logs.inc.pl<br/>アクセスログ取得モジュール</li><li>lib/ogp.inc.pl<br/>Open Graph Protocol モジュール</li><li>lib/pathmenu.inc.pl<br/>階層下に MenuBar等を作れるモジュール</li><li>lib/ping.inc.pl<br/>Weblog ping</li><li>lib/punyurl.inc.pl<br/>国際化ドメインURLに対応する</li><li>lib/setting.inc.pl<br/>閲覧者設定機能</li><li>lib/slashpage.inc.pl<br/>階層下のページ名を容易にリンクする</li><li>lib/trackback.inc.pl<br/>トラックバック</li><li>lib/urlhack.inc.pl<br/>URL改造</li><li>lib/xframe.inc.pl<br/>frame、iframe等でページを表示できないようにする</li></ul><p></p><div class="jumpmenu"><a href="?#navigator">&uarr;</a></div><h2 id="iBCE7A4CAA5D7A5E9A5B0A5A4A5F3B9BDC0AE8">主なプラグイン構成</h2><p>執筆中</p><p></p><p></p><div class="jumpmenu"><a href="?#navigator">&uarr;</a></div><h2 id="i6578706C7567696EBBC5CDCDBEF0CAF39">explugin仕様情報</h2><p></p><div class="jumpmenu"><a href="?#navigator">&uarr;</a></div><h3 id="iBDE9B4FCB2BD10">初期化</h3><ul class="list1"><li>plugin_NAME_init メソッドを起動する</li><li>expluginが有効になっていると、必ず起動されます。</li><li>引数はありませんので、$::form から読み出す必要があります。</li><li>グローバルに変数以外の記述を行なわないで下さい。</li></ul><p></p><div class="jumpmenu"><a href="?#navigator">&uarr;</a></div><h3 id="iCDADB8FAA4CBA4CAA4C3A4C6A4A4A4EB6578706C7567696EA4CEB6AFC0A9C6C9A4DFB9FEA4DF11">有効になっているexpluginの強制読み込み</h3><p>依存関係で、先に読み込む必要があるexpluginは、以下のようにして読み出すことができる。</p><p></p><pre>
&amp;exec_explugin_sub(&quot;explugin name&quot;) ;
</pre><p></p><div class="jumpmenu"><a href="?#navigator">&uarr;</a></div><h3 id="iA5EAA5BDA1BCA5B9A4CEC6C9A4DFB9FEA4DF12">リソースの読み込み</h3>&amp;read_resource で読み込まれます。<p>プラグインと同じ名前のファイルであれば、指定しなくても自動読み込みをします。</p><p></p><div class="jumpmenu"><a href="?#navigator">&uarr;</a></div><h3 id="i4A617661536372697074A1A2435353A4CEC6C9A4DFB9FEA4DF13">JavaScript、CSSの読み込み</h3><p>&amp;jscss_include で読み込まれます。</p><p>プラグインと同じ名前のファイルであれば、指定しなくても自動読み込みをします。</p><p></p><div class="jumpmenu"><a href="?#navigator">&uarr;</a></div><h3 id="iBDE9B4FCB2BDBBFEA4CECAD6A4EAC3CDA1CAA5CFA5C3A5B7A5E5A1CB14">初期化時の返り値（ハッシュ）</h3><p></p><ul class="list1"><li>init<br/>1を指定することで、正常終了したことを通知する。</li><li>func<br/>上書きする関数</li><li>value<br/>上書きする変数名</li><li>msg<br/>タイトル</li><li>body<br/>文書本体</li><li>header<br/>&lt;head&gt;〜&lt;/head&gt;の内容</li><li>http_header<br/>HTTPヘッダー</li><li>cssheader<br/>生のCSS</li><li>jsheader<br/>JavaScriptファイル読み込み後に実行するJavaScript文</li><li>jsheadervalue<br/>ページ表示後すぐに実行するJavaScript文</li><li>bodytag<br/>&lt;body&gt; の中の文</li><li>last_func<br/>ページを表示後に実行する関数</li><li>返り値サンプル<br/></li></ul><pre>
return('init'=&gt;1, func=&gt;'override1,override2',
  'jsheader'=&gt;$javascript, 'lastfunc'=&gt;'&amp;lastcallback;');
</pre><p></p><p></p><div class="jumpmenu"><a href="?#navigator">&uarr;</a></div><h2 id="iA5D7A5E9A5B0A5A4A5F3BBC5CDCDBEF0CAF315">プラグイン仕様情報</h2><p></p><div class="jumpmenu"><a href="?#navigator">&uarr;</a></div><h3 id="iBDE9B4FCB2BD16">初期化</h3><p>メソッドを用いて初期化することはできません。</p><p>グローバルに記述することで、初期化することが可能です。</p><p></p><div class="jumpmenu"><a href="?#navigator">&uarr;</a></div><h3 id="iA5EAA5BDA1BCA5B9A4CEC6C9A4DFB9FEA4DF17">リソースの読み込み</h3><p>&amp;read_resource で読み込まれます。</p><p>プラグインと同じ名前のファイルであれば、指定しなくても自動読み込みをします。</p><p></p><div class="jumpmenu"><a href="?#navigator">&uarr;</a></div><h3 id="i4A617661536372697074A1A2435353A4CEC6C9A4DFB9FEA4DF18">JavaScript、CSSの読み込み</h3><p>&amp;jscss_include で読み込まれます。</p><p>プラグインと同じ名前のファイルであれば、指定しなくても自動読み込みをします。</p><p></p><div class="jumpmenu"><a href="?#navigator">&uarr;</a></div><h3 id="i696E6C696E65A5E1A5BDA5C3A5C919">inlineメソッド</h3><p>&amp;plugin(...) ; で呼び出されます。</p><p>引数は、上記の ... の中身のテキストが入ります。</p><p></p><pre>
sub plugin_NAME_inline {
my @arg=split(/,/,shift);
</pre><p>戻り値は、文字列で、HTMLを返すことにより表示されます。</p><p></p><pre>
return $html;
</pre><p></p><div class="jumpmenu"><a href="?#navigator">&uarr;</a></div><h3 id="i636F6E76657274A5E1A5BDA5C3A5C920">convertメソッド</h3>#plugin (...) で呼び出されます。<p>引数は、上記の ... の中身のテキストが入ります。</p><p></p><pre>
sub plugin_NAME_convert {
my @arg=split(/,/,shift);
</pre><p>戻り値は、文字列で、HTMLを返すことにより表示されます。</p><p></p><pre>
return $html;
</pre><p></p><div class="jumpmenu"><a href="?#navigator">&uarr;</a></div><h3 id="i616374696F6EA5E1A5BDA5C3A5C921">actionメソッド</h3><p>URLの cmd=pluginname で呼び出されます。</p><p>引数はありませんので、$::form から読み出す必要があります。</p><p></p><div class="jumpmenu"><a href="?#navigator">&uarr;</a></div><h3 id="i616374696F6EA5E1A5BDA5C3A5C9A4CECAD6A4EAC3CDA1CAA5CFA5C3A5B7A5E5A1CB22">actionメソッドの返り値（ハッシュ）</h3><p></p><ul class="list1"><li>msg<br/>タイトル</li><li>body<br/>文書本体</li><li>header<br/>&lt;head&gt;〜&lt;/head&gt;の内容</li><li>http_header<br/>HTTPヘッダー</li><li>cssheader<br/>生のCSS</li><li>jsheader<br/>JavaScriptファイル読み込み後に実行するJavaScript文</li><li>jsheadervalue<br/>ページ表示後すぐに実行するJavaScript文</li><li>bodytag<br/>&lt;body&gt; の中の文</li><li>ispage<br/>ページであることを返す</li><li>notviewmenu<br/>予約</li></ul><p></p><p></p><div class="jumpmenu"><a href="?#navigator">&uarr;</a></div><h2 id="iC6E2C9F4CAD1BFF4BBC5CDCDBEF0CAF323">内部変数仕様情報</h2><ul class="list1"><li>$::HTTP_HEADER<br/>HTTPヘッダー</li><li>$::IN_HEAD<br/>&lt;head&gt;〜&lt;/head&gt;</li><li>$::IN_JSHEADVALUE<br/>最初に実行されるJavaScript</li><li>$::IN_JSHEAD<br/>JavaScriptファイル読み込み後に実行されるJavaScript</li><li>$::IN_CSSHEAD<br/>生のCSS</li><li>$::IN_CSSFILES<br/>CSSファイル一覧</li><li>$::IN_JSFILES<br/>JavaScriptファイル一覧</li><li>$::IN_JSLOADER<br/>JavaScriptローダーのHTMLが入る</li><li>$::IN_BODY<br/>&lt;body&gt;の中に入る</li><li>$::IN_TITLE<br/>タイトルタグ</li><li>$::IN_META_ROBOTS<br/>ロボット制御</li><li>%::functions<br/>グローバル関数の一覧</li><li>%::database<br/>wiki/</li><li>%::infobase<br/>info/</li><li>%::diffbase<br/>diff/</li><li>%::backupbase<br/>backup/</li><li>%::resource<br/>リソース</li><li>%::form<br/>フォーム (GET/POST共用）</li><li>$::is_xhtml<br/>XHTMLであれば1</li><li>$::version<br/>バージョン</li><li>$::version_number<br/>バージョン数値（Majer×10000+Miner×100+Sub)</li></ul><p></p><p></p><div class="jumpmenu"><a href="?#navigator">&uarr;</a></div><h2 id="i4A617661536372697074B4D8BFF4BBC5CDCDB0ECCDF724">JavaScript関数仕様一覧</h2>common.???.jsにある関数一覧です。<p></p><div class="jumpmenu"><a href="?#navigator">&uarr;</a></div><h3 id="i756125">ua</h3><dl class="list1"><dt>入力</dt><dd>(ブラウザー名)</dd><dt>出力</dt><dd>true、false</dd></dl><p>使用中のブラウザーの種類を返します。<br/>以下のオプションが選択できます。<br/><br/>MSIE、FIREFOX、GECKO、CHROME、SAFARI、WINDOWS、MACOS、VERSION、MAGERVERSION</p><p></p><div class="jumpmenu"><a href="?#navigator">&uarr;</a></div><h3 id="i6C6E26">ln</h3><dl class="list1"><dt>入力</dt><dd>(langname),(string),(langname),(string)...</dd><dt>出力</dt><dd>string</dd></dl><p>言語セレクターです。<br/>langnameは、en、ja、stringは、対応する言語の出力する文字列です。</p><p></p><div class="jumpmenu"><a href="?#navigator">&uarr;</a></div><h3 id="i73696E7327">sins</h3><dl class="list1"><dt>入力</dt><dd>エレメントオブジェクト, HTML</dd><dt>出力</dt><dd>なし</dd></dl><p>エレメントオブジェクトにinnerhtmlをします。</p><p></p><div class="jumpmenu"><a href="?#navigator">&uarr;</a></div><h3 id="i73696E737328">sinss</h3><dl class="list1"><dt>入力</dt><dd>エレメントオブジェクトの文字列, HTML</dd><dt>出力</dt><dd>なし</dd></dl><p>エレメントオブジェクトの文字列にinnerhtmlをします。</p><p></p><div class="jumpmenu"><a href="?#navigator">&uarr;</a></div><h3 id="i67696429">gid</h3><dl class="list1"><dt>入力</dt><dd>エレメントオブジェクトの文字列</dd><dt>出力</dt><dd>エレメントオブジェクト</dd></dl><p>エレメントオブジェクトを返します。(getElementById)</p><p></p><div class="jumpmenu"><a href="?#navigator">&uarr;</a></div><h3 id="i6F7530">ou</h3><dl class="list1"><dt>入力</dt><dd>URL,target</dd><dt>出力</dt><dd>なし</dd></dl><p>window.openをします。targetの文字列を&quot;b&quot;とすると、&quot;_blank&quot; に入れ替わります。</p><p></p><div class="jumpmenu"><a href="?#navigator">&uarr;</a></div><h3 id="i6B6579436F646531">keyCode</h3><dl class="list1"><dt>入力</dt><dd>イベント</dd><dt>出力</dt><dd>キーコード</dd></dl><p>入力されたキーボードのコードを返します。</p><p></p><div class="jumpmenu"><a href="?#navigator">&uarr;</a></div><h3 id="i676574436C69656E74576964746832">getClientWidth</h3><dl class="list1"><dt>入力</dt><dd>なし</dd><dt>出力</dt><dd>ウィンドウの幅</dd></dl><p>ブラウザーの幅を返します。</p><p></p><div class="jumpmenu"><a href="?#navigator">&uarr;</a></div><h3 id="i676574436C69656E7448656967687433">getClientHeight</h3><dl class="list1"><dt>入力</dt><dd>なし</dd><dt>出力</dt><dd>ウィンドウの高さ</dd></dl><p>ブラウザーの高さを返します。</p><p></p><div class="jumpmenu"><a href="?#navigator">&uarr;</a></div><h3 id="i676574446F6348656967687434">getDocHeight</h3><dl class="list1"><dt>入力</dt><dd>なし</dd><dt>出力</dt><dd>ドキュメントの高さ</dd></dl><p>表示されているページの高さを返します。</p><p></p><div class="jumpmenu"><a href="?#navigator">&uarr;</a></div><h3 id="i6765745363726F6C6C5935">getScrollY</h3><dl class="list1"><dt>入力</dt><dd>なし</dd><dt>出力</dt><dd>現在位置</dd></dl><p>表示されている位置を返します。</p><p></p><div class="jumpmenu"><a href="?#navigator">&uarr;</a></div><h3 id="i617236">ar</h3><dl class="list1"><dt>入力</dt><dd>なし</dd><dt>出力</dt><dd>new Arrayの返り値</dd>new Array を行ないます。</dl><p></p><div class="jumpmenu"><a href="?#navigator">&uarr;</a></div><h3 id="i646566696E656437">defined</h3><dl class="list1"><dt>入力</dt><dd>オブジェクト、変数</dd><dt>出力</dt><dd>true, false</dd>指定したオブジェクト、または変数が存在するか確認します。</dl><p></p><div class="jumpmenu"><a href="?#navigator">&uarr;</a></div><h3 id="i7265706C616365416C6C38">replaceAll</h3><dl class="list1"><dt>入力</dt><dd>文字変数、置換前文字、置換後文字</dd><dt>出力</dt><dd>文字</dd>replaceの全文字対象です。</dl><p></p><div class="jumpmenu"><a href="?#navigator">&uarr;</a></div><h3 id="i6874747039">http</h3><dl class="list1"><dt>入力</dt><dd>メソッド, URL, POSTするデータ, 正常時のコールバック関数, 異常時のコールバック関数</dd><dt>出力</dt><dd>なし</dd></dl><p>http非同期クライアントです。コールバック関数は、以下の通りの引数です。</p><p></p><div class="jumpmenu"><a href="?#navigator">&uarr;</a></div><h4 id="i6F6B66756E6340">okfunc</h4><dl class="list1"><dt>入力</dt><dd>HTTPステータス, レスポンステキスト</dd><dt>出力</dt><dd>なし</dd></dl><p></p><div class="jumpmenu"><a href="?#navigator">&uarr;</a></div><h4 id="i65727266756E6341">errfunc</h4><dl class="list1"><dt>入力</dt><dd>HTTPステータス, レスポンステキスト</dd><dt>出力</dt><dd>なし</dd></dl><p></p><div class="jumpmenu"><a href="?#navigator">&uarr;</a></div><h4 id="i6874747072657142">httpreq</h4><dl class="list1"><dt>入力</dt><dd>なし</dd><dt>出力</dt><dd>http object</dd>ブラウザーのhttpクライアントオブジェクトを返します</dl><p></p><div class="jumpmenu"><a href="?#navigator">&uarr;</a></div><h3 id="i65762E61646443">ev.add</h3><dl class="list1"><dt>入力</dt><dd>イベント名, 実行する関数（文字列）, 実行する関数のパラメータ</dd><dt>出力</dt><dd>なし</dd></dl><p>イベントハンドラーです。対応しているイベントは以下の通り</p><ul class="list1"><li>onload</li><li>onkeypress</li><li>onkeydown</li><li>onkeyup</li><li>onclick</li><li>onbeforeunload</li><li>oncontextmenu</li></ul><p></p><div class="jumpmenu"><a href="?#navigator">&uarr;</a></div><h3 id="i65762E64656C44">ev.del</h3><dl class="list1"><dt>入力</dt><dd>イベント名, 実行する関数（文字列）</dd><dt>出力</dt><dd>なし</dd></dl><p>イベントを削除します</p><p></p><div class="jumpmenu"><a href="?#navigator">&uarr;</a></div><h3 id="i65762E657845">ev.ex</h3><dl class="list1"><dt>入力</dt><dd>イベント名</dd><dt>出力</dt><dd>なし</dd></dl><p>イベントを強制実行します。</p><p></p><div class="jumpmenu"><a href="?#navigator">&uarr;</a></div><h3 id="i646562756746">debug</h3><dl class="list1"><dt>入力</dt><dd>メッセージ</dd><dt>出力</dt><dd>なし</dd></dl><p>デバッグログをtextareaフォーム、及び、console.logに出力します。</p><p></p><p></p><div class="jumpmenu"><a href="?#navigator">&uarr;</a></div><h2 id="i5853B4CAB0D7BBC5CDCDBDF147">XS簡易仕様書</h2><p>現在、XSモジュールは、devel版のみのテスト実装です。</p><p></p><blockquote><blockquote><p class="quotation">&quot;PyukiWiki&quot; ver 0.2.1-customoer-preview $$<br/>Copyright (C) 2005-2015 PukiWiki Developers Team<br/>Copyright (C) 2004-2015 Nekyo (Based on PukiWiki, YukiWiki)<br/>License: GPL version 3 or (at your option) any later version<br/>and/or Artistic version 1 or later version.<br/>Based on YukiWiki <a href="http://www.hyuki.com/yukiwiki/" class="url" target="_blank" title="http://www.hyuki.com/yukiwiki/" rel="nofollow">http://www.hyuki.com/yukiwiki/</a><br/>and PukiWiki <a href="http://pukiwiki.sfjp.jp/" class="url" target="_blank" title="http://pukiwiki.sfjp.jp/" rel="nofollow">http://pukiwiki.sfjp.jp/</a><br/>URL:<br/><a href="http://pyukiwiki.info/" class="url" target="_blank" title="http://pyukiwiki.info/" rel="nofollow">http://pyukiwiki.info/</a><br/><br/>MAIL:<br/>ななみ &lt;nanami (at) daiba (dot) cx&gt; (注：バーチャル女の子です)<br/><br/>$Id$<br/>This text file written UTF-8 Codeset</p></blockquote></blockquote><p></p><div class="jumpmenu"><a href="?#navigator">&uarr;</a></div><h3 id="iCCDCBCA148">目次</h3><div class="contents"> <a id="i636F6E74656E747353"></a> <ul><li><a href="?#i5079756B6957696B69BBC5CDCDBDF1A1CAB2BEA1CB0">PyukiWiki仕様書（仮）</a></li><li><a href="?#iCCDCBCA11">目次</a></li><li><a href="?#iC3EDB0D52">注意</a></li><li><a href="?#i434749B5AFC6B03">CGI起動</a></li><li><a href="?#iA5C7A5A3A5ECA5AFA5C8A5EAB9BDC0AE4">ディレクトリ構成</a></li><li><a href="?#iBCE7A4CACBDCC2CEA5D5A5A1A5A4A5EBB9BDC0AE5">主な本体ファイル構成</a></li><li><a href="?#iBCE7A4CA7065726CA5E2A5B8A5E5A1BCA5EBB9BDC0AE6">主なperlモジュール構成</a></li><li><a href="?#iBCE7A4CA4578706C7567696EB9BDC0AE7">主なExplugin構成</a></li><li><a href="?#iBCE7A4CAA5D7A5E9A5B0A5A4A5F3B9BDC0AE8">主なプラグイン構成</a></li><li><a href="?#i6578706C7567696EBBC5CDCDBEF0CAF39">explugin仕様情報</a></li><ul><li><a href="?#iBDE9B4FCB2BD10">初期化</a></li><li><a href="?#iCDADB8FAA4CBA4CAA4C3A4C6A4A4A4EB6578706C7567696EA4CEB6AFC0A9C6C9A4DFB9FEA4DF11">有効になっているexpluginの強制読み込み</a></li><li><a href="?#iA5EAA5BDA1BCA5B9A4CEC6C9A4DFB9FEA4DF12">リソースの読み込み</a></li><li><a href="?#i4A617661536372697074A1A2435353A4CEC6C9A4DFB9FEA4DF13">JavaScript、CSSの読み込み</a></li><li><a href="?#iBDE9B4FCB2BDBBFEA4CECAD6A4EAC3CDA1CAA5CFA5C3A5B7A5E5A1CB14">初期化時の返り値（ハッシュ）</a></li></ul><li><a href="?#iA5D7A5E9A5B0A5A4A5F3BBC5CDCDBEF0CAF315">プラグイン仕様情報</a></li><ul><li><a href="?#iBDE9B4FCB2BD16">初期化</a></li><li><a href="?#iA5EAA5BDA1BCA5B9A4CEC6C9A4DFB9FEA4DF17">リソースの読み込み</a></li><li><a href="?#i4A617661536372697074A1A2435353A4CEC6C9A4DFB9FEA4DF18">JavaScript、CSSの読み込み</a></li><li><a href="?#i696E6C696E65A5E1A5BDA5C3A5C919">inlineメソッド</a></li><li><a href="?#i636F6E76657274A5E1A5BDA5C3A5C920">convertメソッド</a></li><li><a href="?#i616374696F6EA5E1A5BDA5C3A5C921">actionメソッド</a></li><li><a href="?#i616374696F6EA5E1A5BDA5C3A5C9A4CECAD6A4EAC3CDA1CAA5CFA5C3A5B7A5E5A1CB22">actionメソッドの返り値（ハッシュ）</a></li></ul><li><a href="?#iC6E2C9F4CAD1BFF4BBC5CDCDBEF0CAF323">内部変数仕様情報</a></li><li><a href="?#i4A617661536372697074B4D8BFF4BBC5CDCDB0ECCDF724">JavaScript関数仕様一覧</a></li><ul><li><a href="?#i756125">ua</a></li><li><a href="?#i6C6E26">ln</a></li><li><a href="?#i73696E7327">sins</a></li><li><a href="?#i73696E737328">sinss</a></li><li><a href="?#i67696429">gid</a></li><li><a href="?#i6F7530">ou</a></li><li><a href="?#i6B6579436F646531">keyCode</a></li><li><a href="?#i676574436C69656E74576964746832">getClientWidth</a></li><li><a href="?#i676574436C69656E7448656967687433">getClientHeight</a></li><li><a href="?#i676574446F6348656967687434">getDocHeight</a></li><li><a href="?#i6765745363726F6C6C5935">getScrollY</a></li><li><a href="?#i617236">ar</a></li><li><a href="?#i646566696E656437">defined</a></li><li><a href="?#i7265706C616365416C6C38">replaceAll</a></li><li><a href="?#i6874747039">http</a></li><ul><li><a href="?#i6F6B66756E6340">okfunc</a></li><li><a href="?#i65727266756E6341">errfunc</a></li><li><a href="?#i6874747072657142">httpreq</a></li></ul><li><a href="?#i65762E61646443">ev.add</a></li><li><a href="?#i65762E64656C44">ev.del</a></li><li><a href="?#i65762E657845">ev.ex</a></li><li><a href="?#i646562756746">debug</a></li></ul><li><a href="?#i5853B4CAB0D7BBC5CDCDBDF147">XS簡易仕様書</a></li><ul><li><a href="?#iCCDCBCA148">目次</a></li><li><a href="?#iBCC2C1F5CCDCC9B849">実装目標</a></li><li><a href="?#iA5A4A5F3A5B9A5C8A1BCA5EBC5F950">インストール等</a></li><li><a href="?#i7065726C205853A5E2A5B8A5E5A1BCA5EBA4CEBAEEC0AECAFDCBA151">perl XSモジュールの作成方法</a></li><li><a href="?#iA5D5A5A1A5A4A5EBC6E2CDC652">ファイル内容</a></li></ul></ul></div><p></p><div class="jumpmenu"><a href="?#navigator">&uarr;</a></div><h3 id="iBCC2C1F5CCDCC9B849">実装目標</h3>make installxs をするだけで、あとは何も考えずに、PyukiWikiが高速化する仕組みを作る<p></p><div class="jumpmenu"><a href="?#navigator">&uarr;</a></div><h3 id="iA5A4A5F3A5B9A5C8A1BCA5EBC5F950">インストール等</h3><dl class="list1"><dt>make buildxs</dt><dd>ビルドする</dd><dt>make testxs</dt><dd>テストする</dd><dt>make installxs</dt><dd>インストールをする。blibにファイルコピーをするだけです。<br/>perlモジュール側の make installは使用しないで下さい。</dd><dt>make deinstallxs</dt><dd>アンインストールをする。(blibを単純に削除するだけです。）</dd><dt>make cleanxs</dt><dd>作業ディレクトリを削除する。<br/>作業ファイル名を生成する為に、一度、perl Makefile.PL を実行します。</dd></dl><p></p><div class="jumpmenu"><a href="?#navigator">&uarr;</a></div><h3 id="i7065726C205853A5E2A5B8A5E5A1BCA5EBA4CEBAEEC0AECAFDCBA151">perl XSモジュールの作成方法</h3><pre>
cd src
h2xs -An Name::ModuleName

cd Name-ModuleName
editor ModuleName.xs（とりあえず１行書き換える）

#include &quot;ppport.h&quot;
↓
#include &quot;../xsmake/ppport.h&quot;

editor Makefile.PL （全部書き換える）

use 5.008100;
use ExtUtils::MakeMaker;

require &quot;../xsmake/pyukiwikixs.pl&quot;;

&amp;writemakefile(
	Module=&gt;&quot;Name::ModuleName&quot;,
	File=&gt;&quot;lib/Name/ModuleName.pm&quot;,
	Author=&gt;'作者',
);
</pre><p></p><div class="jumpmenu"><a href="?#navigator">&uarr;</a></div><h3 id="iA5D5A5A1A5A4A5EBC6E2CDC652">ファイル内容</h3><ul class="list1"><li>xsファイルには、可能な限りプロトタイプを指定する。</li><li>xsファイルの中には、C言語コードを最小限しか記述しない<br/>（call、jmp、ret命令相当のオーバーヘッドは出ますが、ここは気にしないで構いません）</li><li>関数の本体は、xs_funcname.c の中に記述する。</li><li>xs_funcname.c に記述できる関数名は、xs_funcname とする</li><li>その他、C言語コードは、視認性より、速度を優先して記述する。<br/></li>わかりにくい部分は、コメントで記述すると良いかもしれません。</ul></body></html>